<!DOCTYPE html><!--Gemini generated-->
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wahlzettel EF 2026/27 - Gymnasium Essen Nord-Ost</title>
    <style>
        :root {
            --primary: #003366;
            --bg: #f4f4f4;
            --paper: #ffffff;
            --border: #ccc;
            --danger: #d9534f;
            --success: #5cb85c;
            --warning: #f0ad4e;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg);
            margin: 0;
            padding: 20px;
            color: #333;
        }

        .container {
            max-width: 900px;
            background: var(--paper);
            margin: 0 auto;
            padding: 40px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            border-top: 5px solid var(--primary);
        }

        /* Header Bereich */
        header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            border-bottom: 2px solid #000;
            padding-bottom: 20px;
            margin-bottom: 20px;
        }

        .school-info h1 { margin: 0; font-size: 1.5rem; color: #000; }
        .school-info h2 { margin: 5px 0 0; font-size: 1rem; font-weight: normal; font-style: italic; }
        .meta-info { text-align: right; font-size: 0.9rem; }

        /* Formular Kopf */
        .student-data {
            display: grid;
            grid-template-columns: 2fr 1fr 1fr;
            gap: 15px;
            margin-bottom: 20px;
            padding: 15px;
            background: #f9f9f9;
            border: 1px solid var(--border);
        }

        .form-group label { display: block; font-weight: bold; margin-bottom: 5px; font-size: 0.9rem; }
        .form-group input, .form-group select { width: 100%; padding: 8px; border: 1px solid var(--border); border-radius: 4px; }

        /* Tabelle */
        table { width: 100%; border-collapse: collapse; margin-bottom: 20px; font-size: 0.95rem; }
        th, td { border: 1px solid var(--border); padding: 8px 12px; vertical-align: middle; }
        th { background-color: #e9ecef; text-align: left; font-weight: bold; }

        .col-field { width: 15%; background: #f8f9fa; font-weight: bold; font-size: 0.85rem; }
        .col-subject { width: 45%; }
        .col-code { width: 10%; text-align: center; }
        .col-hours { width: 10%; text-align: center; }
        .col-select { width: 20%; }

        select.course-select { width: 100%; padding: 5px; border: 1px solid #aaa; border-radius: 3px; }
        select.course-select.written { background-color: #e8f0fe; border-color: var(--primary); color: var(--primary); font-weight: bold; }

        .mandatory { color: var(--danger); font-weight: bold; }
        .note { font-size: 0.8rem; color: #666; display: block; margin-top: 2px; }

        /* Footer / Stats */
        .stats-panel { background: #eee; padding: 20px; border-radius: 5px; margin-top: 20px; }
        .stat-row { display: flex; justify-content: space-between; margin-bottom: 10px; font-weight: bold; }
        
        .validation-box { margin-top: 15px; padding: 10px; border: 1px solid transparent; border-radius: 4px; font-size: 0.9rem; }
        .validation-box.error { background-color: #f2dede; border-color: #ebccd1; color: #a94442; }
        .validation-box.ok { background-color: #dff0d8; border-color: #d6e9c6; color: #3c763d; }
        .validation-box.warning { background-color: #fcf8e3; color: #8a6d3b; border-color: #faebcc; }
        ul.error-list { margin: 0; padding-left: 20px; }

        .info-footer { margin-top: 30px; font-size: 0.85rem; color: #555; border-top: 1px solid #ccc; padding-top: 10px; }

        /* Druck Button Styles */
        .print-btn {
            background-color: var(--primary);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1rem;
            float: right;
            margin-top: -10px;
        }
        .print-btn:hover { background-color: #002244; }

        /* ZUSAMMENFASSUNG F√úR DRUCK (Versteckt auf Bildschirm) */
        #print-summary-container { display: none; }

        /* --- DRUCK MODUS (PDF) --- */
        @media print {
            body { background: white; padding: 0; -webkit-print-color-adjust: exact; }
            .container { box-shadow: none; border: none; padding: 0; width: 100%; max-width: 100%; margin: 0; }
            
            /* Elemente verstecken */
            .no-print, .print-btn, .info-footer, .validation-box, #wahlbogen, .note { display: none !important; }
            
            /* Input Felder im Header durch Text ersetzen (optional, hier lassen wir sie oft sichtbar oder vereinfachen sie) */
            input, select { border: none; background: transparent; appearance: none; font-weight: bold; padding: 0; }
            
            /* Zusammenfassung anzeigen */
            #print-summary-container { display: block !important; margin-top: 20px; }
            
            h1 { font-size: 18pt; }
            table { font-size: 11pt; border: 2px solid #000; }
            th { background-color: #ccc !important; color: #000; border: 1px solid #000; }
            td { border: 1px solid #000; }

            /* Unterschriftenfeld */
            .signature-section {
                margin-top: 50px;
                display: flex;
                justify-content: space-between;
                page-break-inside: avoid;
            }
            .sig-box {
                border-top: 1px solid black;
                width: 40%;
                padding-top: 5px;
                text-align: center;
                font-size: 0.9rem;
            }
        }
    </style>
</head>
<body>

<div class="container">
    <header>
        <div class="school-info">
            <h1>Gymnasium Essen Nord-Ost</h1>
            <h2>leben. lernen. gestalten.</h2>
            <p style="margin: 5px 0 0; font-size: 0.9rem;">Ganztagsschule</p>
        </div>
        <div class="meta-info">
            <button onclick="printPDF()" class="print-btn no-print">üñ®Ô∏è Drucken / PDF</button>
            <br><br>
            <strong>Kurswahl EF</strong><br>
            Schuljahr 2026/2027
        </div>
    </header>

    <div class="student-data">
        <div class="form-group">
            <label>Name, Vorname</label>
            <input type="text" id="studentName" placeholder="Mustermann, Max">
        </div>
        <div class="form-group">
            <label>Klasse (aktuell)</label>
            <input type="text" id="studentClass" placeholder="z.B. 9a">
        </div>
        <div class="form-group">
            <label>Franz√∂sisch 6-10 belegt?</label>
            <select id="prevFrench" onchange="updateLogic()">
                <option value="nein">Nein</option>
                <option value="ja">Ja</option>
            </select>
        </div>
    </div>

    <div id="print-summary-container">
        <h3>Gew√§hlte F√§cher (√úbersicht)</h3>
        <table id="summaryTable">
            <thead>
                <tr>
                    <th style="width:10%">Aufgabenfeld</th>
                    <th style="width:50%">Fach</th>
                    <th style="width:10%">K√ºrzel</th>
                    <th style="width:15%">Art</th>
                    <th style="width:15%">WStd.</th>
                </tr>
            </thead>
            <tbody id="summaryBody">
                </tbody>
            <tfoot>
                <tr style="font-weight:bold; background:#eee;">
                    <td colspan="4" style="text-align:right">Gesamt Wochenstunden:</td>
                    <td id="printSumHours" style="text-align:center">0</td>
                </tr>
                <tr style="font-weight:bold; background:#eee;">
                    <td colspan="4" style="text-align:right">Anzahl Klausurf√§cher:</td>
                    <td id="printSumWritten" style="text-align:center">0</td>
                </tr>
            </tfoot>
        </table>

        <div class="signature-section">
            <div class="sig-box">Datum, Unterschrift Sch√ºler/in</div>
            <div class="sig-box">Datum, Unterschrift Erziehungsberechtigte</div>
        </div>
    </div>

    <div id="wahlbogen">
        <p style="font-size: 0.9rem; margin-bottom: 15px;" class="no-print">
            <strong>Hinweise:</strong> Pflichtf√§cher sind mit <span class="mandatory">*</span> markiert.
            Ein Kurs gilt als gew√§hlt, wenn "Schriftlich" (S) oder "M√ºndlich" (M) ausgew√§hlt wird.
        </p>

        <form>
            <table>
                <thead>
                    <tr>
                        <th class="col-field">Aufgabenfeld</th>
                        <th class="col-subject">Fach</th>
                        <th class="col-code">K√ºrzel</th>
                        <th class="col-hours">WStd.</th>
                        <th class="col-select">Wahl (M/S)</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td rowspan="7" class="col-field">1<br>sprachlich-<br>literarisch-<br>k√ºnstlerisch</td>
                        <td><span class="mandatory">*</span> Deutsch</td>
                        <td class="col-code">D</td><td class="col-code">3</td>
                        <td><select class="course-select" id="D" data-name="Deutsch" data-hours="3" data-field="1" onchange="updateLogic()"><option value="S">Schriftlich</option></select></td>
                    </tr>
                    <tr>
                        <td><span class="mandatory">*</span> Fortg. Fremdsprache</td>
                        <td class="col-code">E5</td><td class="col-code">3</td>
                        <td><select class="course-select" id="E5" data-name="Englisch (E5)" data-hours="3" data-field="1" data-type="FS" onchange="updateLogic()"><option value="S">Schriftlich</option><option value="">Nicht gew√§hlt</option></select></td>
                    </tr>
                    <tr>
                        <td>2. Fremdsprache / Neu</td>
                        <td class="col-code"><select id="fs2_code" onchange="updateLogic()" style="width:100%"><option value="F6">F6</option><option value="L6">L6</option><option value="S1">S1 (neu)</option><option value="R1">R1 (neu)</option></select></td>
                        <td class="col-code" id="fs2_hours">3</td>
                        <td><select class="course-select" id="FS2" data-name="2. Fremdsprache" data-field="1" data-type="FS" onchange="updateLogic()"><option value="">Nicht gew√§hlt</option><option value="S">Schriftlich</option><option value="M">M√ºndlich</option></select></td>
                    </tr>
                    <tr>
                        <td>3. Fremdsprache</td>
                        <td class="col-code"><select id="fs3_code" onchange="updateLogic()" style="width:100%"><option value="L6">L6</option><option value="S1">S1</option><option value="R1">R1</option></select></td>
                        <td class="col-code" id="fs3_hours">3</td>
                        <td><select class="course-select" id="FS3" data-name="3. Fremdsprache" data-field="1" data-type="FS" onchange="updateLogic()"><option value="">Nicht gew√§hlt</option><option value="S">Schriftlich</option><option value="M">M√ºndlich</option></select></td>
                    </tr>
                    <tr>
                        <td><span class="mandatory">*</span> Kunst oder Musik</td>
                        <td class="col-code">KU</td><td class="col-code">3</td>
                        <td><select class="course-select" id="KU" data-name="Kunst" data-hours="3" data-field="1" data-type="KUMU" onchange="updateLogic()"><option value="">Nicht gew√§hlt</option><option value="M">M√ºndlich</option><option value="S">Schriftlich</option></select></td>
                    </tr>
                    <tr>
                        <td>Musik (alternativ)</td>
                        <td class="col-code">MU</td><td class="col-code">3</td>
                        <td><select class="course-select" id="MU" data-name="Musik" data-hours="3" data-field="1" data-type="KUMU" onchange="updateLogic()"><option value="">Nicht gew√§hlt</option><option value="M">M√ºndlich</option><option value="S">Schriftlich</option></select></td>
                    </tr>
                    <tr><td colspan="4" style="background:#eee; height:5px; padding:0;"></td></tr>

                    <tr>
                        <td rowspan="5" class="col-field">2<br>gesellschafts-<br>wiss.</td>
                        <td><span class="mandatory">*</span> P√§dagogik</td>
                        <td class="col-code">PA</td><td class="col-code">3</td>
                        <td><select class="course-select" id="PA" data-name="P√§dagogik" data-hours="3" data-field="2" onchange="updateLogic()"><option value="">Nicht gew√§hlt</option><option value="M">M√ºndlich</option><option value="S">Schriftlich</option></select></td>
                    </tr>
                    <tr>
                        <td>Geschichte</td>
                        <td class="col-code">GE</td><td class="col-code">3</td>
                        <td><select class="course-select" id="GE" data-name="Geschichte" data-hours="3" data-field="2" onchange="updateLogic()"><option value="">Nicht gew√§hlt</option><option value="M">M√ºndlich</option><option value="S">Schriftlich</option></select></td>
                    </tr>
                    <tr>
                        <td>Sozialwissenschaften</td>
                        <td class="col-code">SW</td><td class="col-code">3</td>
                        <td><select class="course-select" id="SW" data-name="Sozialwiss." data-hours="3" data-field="2" onchange="updateLogic()"><option value="">Nicht gew√§hlt</option><option value="M">M√ºndlich</option><option value="S">Schriftlich</option></select></td>
                    </tr>
                    <tr>
                        <td>Erdkunde</td>
                        <td class="col-code">EK</td><td class="col-code">3</td>
                        <td><select class="course-select" id="EK" data-name="Erdkunde" data-hours="3" data-field="2" onchange="updateLogic()"><option value="">Nicht gew√§hlt</option><option value="M">M√ºndlich</option><option value="S">Schriftlich</option></select></td>
                    </tr>
                    <tr>
                        <td>Philosophie (GW)</td>
                        <td class="col-code">PL</td><td class="col-code">3</td>
                        <td><select class="course-select" id="PL_GW" data-name="Philosophie (GW)" data-hours="3" data-field="2" onchange="updateLogic()"><option value="">Nicht gew√§hlt</option><option value="M">M√ºndlich</option><option value="S">Schriftlich</option></select></td>
                    </tr>

                    <tr>
                        <td rowspan="6" class="col-field">3<br>math.-<br>naturwiss.</td>
                        <td><span class="mandatory">*</span> Mathematik</td>
                        <td class="col-code">M</td><td class="col-code">3</td>
                        <td><select class="course-select" id="M" data-name="Mathematik" data-hours="3" data-field="3" onchange="updateLogic()"><option value="S">Schriftlich</option></select></td>
                    </tr>
                    <tr>
                        <td><span class="mandatory">*</span> Biologie</td>
                        <td class="col-code">BI</td><td class="col-code">3</td>
                        <td><select class="course-select" id="BI" data-name="Biologie" data-hours="3" data-field="3" data-type="NW" onchange="updateLogic()"><option value="">Nicht gew√§hlt</option><option value="M">M√ºndlich</option><option value="S">Schriftlich</option></select></td>
                    </tr>
                    <tr>
                        <td>Physik</td>
                        <td class="col-code">PH</td><td class="col-code">3</td>
                        <td><select class="course-select" id="PH" data-name="Physik" data-hours="3" data-field="3" data-type="NW" onchange="updateLogic()"><option value="">Nicht gew√§hlt</option><option value="M">M√ºndlich</option><option value="S">Schriftlich</option></select></td>
                    </tr>
                    <tr>
                        <td>Chemie</td>
                        <td class="col-code">CH</td><td class="col-code">3</td>
                        <td><select class="course-select" id="CH" data-name="Chemie" data-hours="3" data-field="3" data-type="NW" onchange="updateLogic()"><option value="">Nicht gew√§hlt</option><option value="M">M√ºndlich</option><option value="S">Schriftlich</option></select></td>
                    </tr>
                    <tr>
                        <td>Informatik (nur 2. NW)</td>
                        <td class="col-code">IF</td><td class="col-code">3</td>
                        <td><select class="course-select" id="IF" data-name="Informatik" data-hours="3" data-field="3" data-type="NW" onchange="updateLogic()"><option value="">Nicht gew√§hlt</option><option value="M">M√ºndlich</option><option value="S">Schriftlich</option></select></td>
                    </tr>
                    <tr><td colspan="4" style="background:#eee; height:5px; padding:0;"></td></tr>

                    <tr>
                        <td rowspan="3" class="col-field">Ohne Feld</td>
                        <td><span class="mandatory">*</span> Religion / Philosophie</td>
                        <td class="col-code">Rel/Pl</td><td class="col-code">3</td>
                        <td><select class="course-select" id="REL" data-name="Religion/Philo" data-hours="3" data-field="0" onchange="updateLogic()">
                            <option value="">Nicht gew√§hlt</option>
                            <option value="ER_M">Ev. Religion (m)</option>
                            <option value="KR_M">Kath. Religion (m)</option>
                            <option value="PL_M">Philosophie (Ersatz) (m)</option>
                            <option value="ER_S">Ev. Religion (s)</option>
                            <option value="KR_S">Kath. Religion (s)</option>
                            <option value="PL_S">Philosophie (Ersatz) (s)</option>
                        </select></td>
                    </tr>
                    <tr>
                        <td><span class="mandatory">*</span> Sport</td>
                        <td class="col-code">SP</td><td class="col-code">3</td>
                        <td><select class="course-select" id="SP" data-name="Sport" data-hours="3" data-field="0" onchange="updateLogic()"><option value="M">Teilnahme</option></select></td>
                    </tr>
                    <tr><td colspan="4" style="background:#eee; height:5px; padding:0;"></td></tr>

                    <tr>
                        <td class="col-field">Vertiefung</td>
                        <td>Vertiefungskurse</td>
                        <td class="col-code">VX</td><td class="col-code">2</td>
                        <td><select class="course-select" id="VX" data-name="Vertiefung" data-hours="2" data-field="0" onchange="updateLogic()">
                            <option value="">Nicht gew√§hlt</option>
                            <option value="D">Deutsch</option>
                            <option value="E">Englisch</option>
                            <option value="M">Mathe</option>
                        </select></td>
                    </tr>
                </tbody>
            </table>
        </form>
    </div>

    <div class="stats-panel no-print">
        <div class="stat-row">
            <span>Summe Wochenstunden (min. 34 / max. 37):</span>
            <span id="sumHours">0</span>
        </div>
        <div class="stat-row">
            <span>Anzahl Klausurf√§cher (min. 5 / max. 8):</span>
            <span id="sumWritten">0</span>
        </div>
        <div id="validationOutput" class="validation-box">Bitte F√§cher w√§hlen...</div>
    </div>

    <div class="info-footer no-print">
        <p><strong>Wichtige Termine:</strong> Die Kurswahlen finden vom <strong>16.03.2026 bis 20.03.2026</strong> statt (Raum 119).</p>
    </div>
</div>

<script>
    // Globale Variablen f√ºr Stundenlogik
    let currentTotalHours = 0;
    let currentWrittenCount = 0;

    function updateLogic() {
        let totalHours = 0;
        let totalWritten = 0;
        let errors = [];
        let warnings = [];

        const form = document.getElementById('wahlbogen');
        const selects = form.querySelectorAll('select.course-select');
        
        // Dynamische Stunden f√ºr FS2/FS3
        const fs2Code = document.getElementById('fs2_code').value;
        const fs2Hours = (fs2Code === 'S1' || fs2Code === 'R1') ? 4 : 3;
        document.getElementById('fs2_hours').innerText = fs2Hours;
        
        const fs3Code = document.getElementById('fs3_code').value;
        const fs3Hours = (fs3Code === 'S1' || fs3Code === 'R1') ? 4 : 3;
        document.getElementById('fs3_hours').innerText = fs3Hours;

        selects.forEach(s => s.classList.remove('written'));

        let countFS = 0, countNW = 0, countGW = 0, countKUMU = 0, hasRelOrPL = false;
        let gwWritten = false, nwWritten = false, fs2Written = false;

        selects.forEach(select => {
            const val = select.value;
            if (!val) return;

            let hours = parseInt(select.getAttribute('data-hours'));
            if (select.id === 'FS2') hours = fs2Hours;
            if (select.id === 'FS3') hours = fs3Hours;

            // Ist schriftlich?
            let isWritten = (val === 'S' || val.endsWith('_S'));
            if (isWritten) {
                totalWritten++;
                select.classList.add('written');
                if (select.getAttribute('data-field') === '2') gwWritten = true;
                if (select.getAttribute('data-type') === 'NW') nwWritten = true;
                if (select.id === 'FS2') fs2Written = true;
            }

            if (select.id !== 'SP') totalHours += hours; else totalHours += hours; 

            // Kategorien
            const type = select.getAttribute('data-type');
            const field = select.getAttribute('data-field');

            if (select.id === 'E5' || select.id === 'FS2' || select.id === 'FS3') countFS++;
            if (select.id === 'KU' || select.id === 'MU') countKUMU++;
            if (field === '2') countGW++;
            if (type === 'NW') countNW++;
            if (select.id === 'REL') hasRelOrPL = true;
        });

        currentTotalHours = totalHours;
        currentWrittenCount = totalWritten;

        // Validierung
        if (!document.getElementById('D').value) errors.push("Deutsch ist Pflicht.");
        if (!document.getElementById('E5').value) errors.push("Fortgef√ºhrte FS (E5) ist Pflicht.");
        if (!document.getElementById('M').value) errors.push("Mathe ist Pflicht.");
        if (!document.getElementById('SP').value) errors.push("Sport ist Pflicht.");
        if (countKUMU === 0) errors.push("Kunst oder Musik Pflicht.");
        if (countGW === 0) errors.push("Mind. eine Gesellschaftswissenschaft Pflicht.");
        if (!hasRelOrPL) errors.push("Religion oder Philosophie Pflicht.");
        
        const isLingProfile = (countFS >= 2);
        const isSciProfile = (countNW >= 2);
        if (!isLingProfile && !isSciProfile) errors.push("Schwerpunkt fehlt (2. FS oder 2. NW w√§hlen).");
        if (countNW === 0) errors.push("Mind. eine klassische Naturwissenschaft (BI, PH, CH) Pflicht.");
        
        const ifSelect = document.getElementById('IF').value;
        if (ifSelect && countNW < 2) errors.push("Informatik nur als 2. NW w√§hlbar.");

        if (!gwWritten && !nwWritten && !fs2Written) warnings.push("Schwerpunktfach: I.d.R. muss ein weiteres Fach schriftlich sein (FS, GW oder NW).");

        document.getElementById('sumHours').innerText = totalHours;
        document.getElementById('sumWritten').innerText = totalWritten;

        const valBox = document.getElementById('validationOutput');
        valBox.className = 'validation-box';
        
        if (errors.length > 0) {
            valBox.classList.add('error');
            valBox.innerHTML = "<strong>Fehler:</strong><ul class='error-list'>" + errors.map(e => `<li>${e}</li>`).join('') + "</ul>";
        } else if (warnings.length > 0) {
            valBox.classList.add('warning');
            valBox.innerHTML = "<strong>Hinweise:</strong><ul class='error-list'>" + warnings.map(w => `<li>${w}</li>`).join('') + "</ul>";
        } else {
            valBox.classList.add('ok');
            valBox.innerHTML = "<strong>Wahl g√ºltig!</strong> Alle Bedingungen scheinen erf√ºllt.";
        }
    }

    // --- PDF DRUCK FUNKTION ---
    function printPDF() {
        // 1. Zusammenfassungstabelle f√ºllen
        const tbody = document.getElementById('summaryBody');
        tbody.innerHTML = '';
        
        const selects = document.querySelectorAll('select.course-select');
        let rows = [];

        // Daten sammeln
        selects.forEach(sel => {
            if(!sel.value) return;

            let name = sel.getAttribute('data-name');
            let code = sel.id;
            let field = sel.getAttribute('data-field');
            let typeCode = sel.value; // M, S, ER_S...
            
            // Namen verfeinern
            if(code === 'FS2') {
                code = document.getElementById('fs2_code').value;
                name = "2. Fremdsprache (" + code + ")";
            }
            if(code === 'FS3') {
                code = document.getElementById('fs3_code').value;
                name = "3. Fremdsprache (" + code + ")";
            }
            if(code === 'VX') {
                 // Vertiefung
                 const sub = sel.options[sel.selectedIndex].text;
                 name = "Vertiefung: " + sub;
            }

            // Stunden
            let hours = parseInt(sel.getAttribute('data-hours'));
            if (sel.id === 'FS2') hours = parseInt(document.getElementById('fs2_hours').innerText);
            if (sel.id === 'FS3') hours = parseInt(document.getElementById('fs3_hours').innerText);

            // Art (Lesbar machen)
            let typeText = "M√ºndlich";
            if(typeCode === 'S' || typeCode.includes('_S')) typeText = "Schriftlich";
            if(code === 'SP') typeText = "Teilnahme"; // Sport

            rows.push({ field, name, code, typeText, hours });
        });

        // Sortieren nach Feld
        rows.sort((a,b) => a.field - b.field);

        // Rendern
        rows.forEach(r => {
            let tr = document.createElement('tr');
            let fieldTxt = (r.field === '0') ? '-' : r.field;
            tr.innerHTML = `
                <td style="text-align:center">${fieldTxt}</td>
                <td>${r.name}</td>
                <td style="text-align:center">${r.code}</td>
                <td>${r.typeText}</td>
                <td style="text-align:center">${r.hours}</td>
            `;
            tbody.appendChild(tr);
        });

        // Footer Stats im Print
        document.getElementById('printSumHours').innerText = currentTotalHours;
        document.getElementById('printSumWritten').innerText = currentWrittenCount;

        // 2. Druckdialog √∂ffnen
        window.print();
    }

    // Initialisierung
    updateLogic();
</script>

</body>
</html>
